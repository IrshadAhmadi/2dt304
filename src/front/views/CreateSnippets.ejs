<!DOCTYPE html>
<html>
<head>
    <title>Create a Snippet</title>
    <link rel="stylesheet" href="/css/snippet.css">
    <link rel="stylesheet" href="/css/main.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.3.1/styles/default.min.css">
</head>
<body>
    
    <%- include('navbar', { user: user }) %>
    <h1>Create a New Snippet</h1>
    <form class="container-form" action="/snippets" method="POST" id="snippetForm">
        <div>
            <label for="title">Title:</label>
            <input type="text" id="title" name="title" required>
        </div>
        <div>
            <label for="language">Language:</label>
            <select id="language" name="language">
                <option value="javascript">JavaScript</option>
                <option value="python">Python</option>
                <option value="html">HTML</option>
                <option value="css">CSS</option>
                <option value="plaintext">Plain Text</option> 
            </select>
        </div>
        <div>
            <label for="content">Content:</label>

            <div id="codeInput" contenteditable="true" class="hljs"></div>
            <input type="hidden" name="content" id="hiddenContent">
        </div>
        <button type="submit">Create Snippet</button>
    </form>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.3.1/highlight.min.js"></script>
    <script>
        const codeInput = document.getElementById('codeInput');
        const hiddenContent = document.getElementById('hiddenContent');
        const languageSelector = document.getElementById('language');
    
        function applyHighlighting() {
            codeInput.className = `hljs ${languageSelector.value}`;
            hiddenContent.value = codeInput.innerText;
            hljs.highlightElement(codeInput);
        }
        codeInput.addEventListener('input', applyHighlighting);
        languageSelector.addEventListener('change', applyHighlighting);
        applyHighlighting();
    </script>
</body>
</html>
